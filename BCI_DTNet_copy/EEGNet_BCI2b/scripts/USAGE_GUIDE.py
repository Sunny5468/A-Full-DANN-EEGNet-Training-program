"""
超参数调优系统 - 使用演示
展示完整的使用流程
"""

print("""
╔══════════════════════════════════════════════════════════════════════════╗
║                   DANN-EEGNet 超参数自动调优系统                          ║
║                      Hyperparameter Tuning System                         ║
╚══════════════════════════════════════════════════════════════════════════╝

📋 系统组件
─────────────────────────────────────────────────────────────────────────

1. 核心脚本
   ├─ hyperparameter_tuning.py      主调优引擎 (640行)
   ├─ models_dann.py                DANN模型定义
   └─ preprocess.py                 数据加载

2. 配置文件
   ├─ hyperparam_config_quick.yaml  ⭐ 快速测试 (4配置×2被试=8模型)
   └─ hyperparam_config.yaml        完整搜索 (972配置×9被试=8748模型)

3. 辅助工具
   ├─ test_hyperparameter_system.py  ⭐ 系统测试
   ├─ run_tuning.py                  ⭐ 交互式启动
   └─ view_tuning_results.py         ⭐ 结果查看

4. 文档
   ├─ QUICKSTART.md                  ⭐ 快速入门
   ├─ README_HYPERPARAMETER_TUNING.md 详细文档
   ├─ PROJECT_SUMMARY.md             项目总结
   └─ README_TUNING.md               导航文档

═══════════════════════════════════════════════════════════════════════════

🚀 使用流程（推荐新手）
─────────────────────────────────────────────────────────────────────────

步骤 1: 测试系统
    命令: python test_hyperparameter_system.py
    时间: 1-2分钟
    目标: 确保所有模块正常工作 (6/6 通过)
    ✓ 配置加载
    ✓ 模块导入
    ✓ 模型创建
    ✓ 网格生成
    ✓ 数据准备
    ✓ 训练测试(可选)

步骤 2: 快速试运行
    命令: python run_tuning.py
    选择: [1] 快速测试配置
    时间: 15-20分钟
    输出: 4个配置 × 2个被试 = 8个模型的完整结果

步骤 3: 查看结果
    命令: python view_tuning_results.py
    功能:
    - 显示最佳配置
    - Top 5 配置排名
    - 统计信息
    - 生成对比图表

═══════════════════════════════════════════════════════════════════════════

📊 输出结果结构
─────────────────────────────────────────────────────────────────────────

hyperparameter_tuning_results/
└── hyperparam_tuning_20241107_162345/
    ├── best_config.json          ⭐ 最佳配置（重要！）
    │   └─ 包含: 参数、准确率、标准差、训练时间
    │
    ├── results_summary.csv        Excel可打开的汇总表
    │
    ├── REPORT.txt                完整文本报告
    │   └─ 最佳配置、Top 10排名、详细分析
    │
    ├── 可视化图表
    │   ├─ ranking.png            性能排名柱状图
    │   ├─ param_effects.png      参数影响分析
    │   └─ val_vs_test.png        验证vs测试对比
    │
    └── 详细结果
        ├─ config_001/
        │   ├─ config.json        配置详情
        │   ├─ summary.json       性能摘要
        │   └─ subject_1/
        │       ├─ subject-1.weights.h5    模型权重
        │       └─ history_sub1.json       训练历史
        ├─ config_002/
        └─ ...

═══════════════════════════════════════════════════════════════════════════

⚙️ 可调参数说明
─────────────────────────────────────────────────────────────────────────

参数              默认范围                 影响              重要性
─────────────────────────────────────────────────────────────────────────
epochs          [100, 150, 200]         收敛程度            ⭐⭐⭐
lr              [0.0001~0.002]          训练速度/稳定性      ⭐⭐⭐⭐⭐
gamma           [8.0, 10.0, 12.0]       域对抗强度          ⭐⭐⭐
batch_size      [32, 64, 128]           内存/速度           ⭐⭐
label_weight    [1.0, 1.5, 2.0]         任务vs域平衡        ⭐⭐⭐⭐
domain_weight   [0.5, 1.0, 1.5]         域分类重要性         ⭐⭐⭐

═══════════════════════════════════════════════════════════════════════════

💡 使用建议
─────────────────────────────────────────────────────────────────────────

1. 首次使用：
   ✓ 先运行 test_hyperparameter_system.py 确认环境
   ✓ 使用 quick 配置熟悉流程
   ✓ 查看生成的所有文件类型

2. 实际调优：
   ✓ 第一轮：粗搜索（每个参数2-3个值，全部被试）
   ✓ 第二轮：细搜索（在最优区域增加密度）
   ✓ 第三轮：验证（最佳配置重复3-5次）

3. 资源规划：
   ✓ 磁盘空间：每个实验约 500MB - 2GB
   ✓ 时间：100 epochs ≈ 6分钟/被试
   ✓ 内存：batch_size=64 约需 2-3GB

4. 结果应用：
   ✓ 从 best_config.json 获取最优参数
   ✓ 更新 main_DANN_EEGNet_BCI2b_LOSO.py
   ✓ 重新训练验证性能

═══════════════════════════════════════════════════════════════════════════

🎯 性能目标
─────────────────────────────────────────────────────────────────────────

方法                测试准确率      标准差        说明
─────────────────────────────────────────────────────────────────────────
标准EEGNet          76.11%         ±8.2%        无域对抗
DANN-EEGNet(初始)   75.34%         ±7.9%        默认参数
DANN-EEGNet(目标)   ≥77.0%         <8.0%        调优后期望

═══════════════════════════════════════════════════════════════════════════

📞 常见问题 FAQ
─────────────────────────────────────────────────────────────────────────

Q1: 如何中断正在运行的调优？
A1: 按 Ctrl+C，已完成的结果会自动保存

Q2: 如何修改搜索的参数？
A2: 编辑 .yaml 配置文件，修改 values 列表

Q3: 训练太慢怎么办？
A3: 减少 epochs、使用早停、减少配置数量

Q4: 如何使用找到的最佳配置？
A4: 查看 best_config.json，复制参数到训练脚本

Q5: 可以同时运行多个实验吗？
A5: 可以，每个实验会创建独立的时间戳目录

═══════════════════════════════════════════════════════════════════════════

📈 时间估算参考
─────────────────────────────────────────────────────────────────────────

配置规模            配置数×被试        预计时间        用途
─────────────────────────────────────────────────────────────────────────
快速测试            4 × 2 = 8         15-20分钟       系统验证
小规模调优          16 × 5 = 80       4-6小时         初步筛选
中规模调优          32 × 9 = 288      1-2天           粗搜索
大规模调优          48 × 9 = 432      2-3天           细搜索
完整搜索            972 × 9 = 8748    30-50天         不推荐

═══════════════════════════════════════════════════════════════════════════

✨ 立即开始
─────────────────────────────────────────────────────────────────────────

在 PowerShell 中执行以下命令:

    cd c:\\Users\\35696\\BCI_DTNet_copy\\EEGNet_BCI2b
    
    # 测试系统
    python test_hyperparameter_system.py
    
    # 开始调优（交互式）
    python run_tuning.py
    
    # 查看结果
    python view_tuning_results.py

═══════════════════════════════════════════════════════════════════════════

📚 获取更多帮助
─────────────────────────────────────────────────────────────────────────

- 快速入门:     打开 QUICKSTART.md
- 详细文档:     打开 README_HYPERPARAMETER_TUNING.md
- 项目总结:     打开 PROJECT_SUMMARY.md
- 导航指南:     打开 README_TUNING.md

═══════════════════════════════════════════════════════════════════════════

祝调优顺利！🎉

""")

if __name__ == "__main__":
    import sys
    
    print("\n按任意键查看详细文档...")
    if sys.platform == 'win32':
        import msvcrt
        msvcrt.getch()
    
    print("\n推荐阅读顺序:")
    print("1. QUICKSTART.md - 快速入门")
    print("2. README_TUNING.md - 导航文档")
    print("3. PROJECT_SUMMARY.md - 系统总结")
